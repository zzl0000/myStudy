/* eslint-disable */
var gulp = require('gulp');
var sass = require('gulp-sass');
var prefix = require('gulp-autoprefixer');
var cssmin = require('gulp-cssmin');
var rename = require('gulp-rename');
var browserSync = require('browser-sync');

var production = process.env.NODE_ENV === 'production';

var config = {
  port: 9000,
  paths: {
    styles: './scss/*.scss',
    mainScss: './scss/grund.scss',
    distCss: './dist/css',
  }
};


/*
 |--------------------------------------------------------------------------
 | Compile scss stylesheets.
 |--------------------------------------------------------------------------
*/
gulp.task('styles', function () {
  gulp.src(config.paths.mainScss)
    .pipe(sass().on('error', sass.logError))
    .pipe(prefix())
    .pipe(gulp.dest(config.paths.distCss));
});

gulp.task('minifyStyles', function () {
  gulp.src(config.paths.mainScss)
    .pipe(sass().on('error', sass.logError))
    .pipe(prefix())
    .pipe(cssmin())
    .pipe(rename({
      suffix: '.min'
    }))
    .pipe(gulp.dest(config.paths.distCss));
});


/*
 |--------------------------------------------------------------------------
 | Compile scss and reload browser.
 |--------------------------------------------------------------------------
*/
gulp.task('styles-watch', ['styles'], browserSync.reload);


/*
 |--------------------------------------------------------------------------
 | Run browser-sync server and watch for changes.
 |--------------------------------------------------------------------------
*/
gulp.task('watch', function () {
  browserSync.init({
    server: './',
    port: config.port,
  });

  gulp.watch(config.paths.styles, ['styles-watch']);
});


/*
 |--------------------------------------------------------------------------
 | Run tasks
 |--------------------------------------------------------------------------
*/
gulp.task('default', ['styles', 'watch']);
gulp.task('build', ['styles', 'minifyStyles']);
